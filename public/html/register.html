<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProducPlus - Cadastro</title>
    <link rel="shortcut icon" href="../assets/images/favicon/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../assets/style/login.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
</head>

<body>
    <header>
        <nav>

        </nav>
    </header>

    <main>
        <div class="main-content-login">

            <div class="block-hero-login">
                <img src="../assets/images/svg/register_hero_ProducPlus.svg" alt="">
            </div>

            <section class="section-content-login">
                <div class="section-content-img-login">
                    <a href="index.html" target="_parent"><img src="../assets/images/svg/logo_extensa_ProducPlus.svg"
                            alt=""></a>
                </div>
                <div class="section-content-h1-login">
                    <h1> A <span style="color: #1714A8;">indústria</span> mais perto de você</h1>
                </div>
                <div class="content-size-login">
                    <div class="inputs-login">
                        <div class="wave-group">
                            <input required type="text" class="input" id="cnpjReg">
                            <span class="bar"></span>
                            <label class="label">
                                <span class="label-char" style="--index: 0">C</span>
                                <span class="label-char" style="--index: 1">N</span>
                                <span class="label-char" style="--index: 2">P</span>
                                <span class="label-char" style="--index: 3">J</span>
                            </label>
                        </div>

                        <div class="wave-group">
                            <input required type="text" class="input" id="nomeReg">
                            <span class="bar"></span>
                            <label class="label">
                                <span class="label-char" style="--index: 0">N</span>
                                <span class="label-char" style="--index: 1">o</span>
                                <span class="label-char" style="--index: 2">m</span>
                                <span class="label-char" style="--index: 3">e</span>
                            </label>
                        </div>

                        <div class="wave-group">
                            <input required type="email" class="input" id="emailReg">
                            <span class="bar"></span>
                            <label class="label">
                                <span class="label-char" style="--index: 0">E</span>
                                <span class="label-char" style="--index: 1">m</span>
                                <span class="label-char" style="--index: 2">a</span>
                                <span class="label-char" style="--index: 3">i</span>
                                <span class="label-char" style="--index: 4">l</span>
                            </label>
                        </div>
                         <div class="wave-group">
                            <input required="" type="cnpj" class="input">
                            <span class="bar"></span>
                            <label class="label">
                                <span class="label-char" style="--index: 0">C</span>
                                <span class="label-char" style="--index: 1">N</span>
                                <span class="label-char" style="--index: 2">P</span>
                                <span class="label-char" style="--index: 3">J</span>
                            </label>
                        </div>

                        <div class="wave-group">
                            <input required type="text" class="input" id="telReg">
                            <span class="bar"></span>
                            <label class="label">
                                <span class="label-char" style="--index: 0">T</span>
                                <span class="label-char" style="--index: 1">e</span>
                                <span class="label-char" style="--index: 2">l</span>
                                <span class="label-char" style="--index: 3">e</span>
                                <span class="label-char" style="--index: 4">f</span>
                                <span class="label-char" style="--index: 5">o</span>
                                <span class="label-char" style="--index: 6">n</span>
                                <span class="label-char" style="--index: 7">e</span>
                            </label>
                        </div>

                        <div class="wave-group">
                            <input required type="text" class="input" id="endReg">
                            <span class="bar"></span>
                            <label class="label">
                                <span class="label-char" style="--index: 0">E</span>
                                <span class="label-char" style="--index: 1">n</span>
                                <span class="label-char" style="--index: 3">d</span>
                                <span class="label-char" style="--index: 4">e</span>
                                <span class="label-char" style="--index: 5">r</span>
                                <span class="label-char" style="--index: 6">e</span>
                                <span class="label-char" style="--index: 7">ç</span>
                                <span class="label-char" style="--index: 8">o</span>
                            </label>
                        </div>

                        <div class="wave-group">
                            <input required type="password" class="input" id="senhaReg">
                            <span class="bar"></span>
                            <label class="label">
                                <span class="label-char" style="--index: 0">S</span>
                                <span class="label-char" style="--index: 1">e</span>
                                <span class="label-char" style="--index: 2">n</span>
                                <span class="label-char" style="--index: 3">h</span>
                                <span class="label-char" style="--index: 4">a</span>
                            </label>
                        </div>

                        <a class="btn-action" href="#" id="btnRegistrar">
                            Criar conta
                        </a>
                        <h3>Já tem uma conta? <a href="login.html" target="_parent" style="color: #1714A8;">Faça
                                Login</a></h3>
                        <br>
                        <h4>Ao entrar você concorda com os <a href="#" style="color: gray;">termos de condição</a> da
                            ProducPlus</h4>
            </section>

        </div>

    </main>

    <footer>

    </footer>
    <script src="https://unpkg.com/imask"></script>
    <script>
        const API_URL = 'http://localhost:3000';

        const cnpjInput = document.getElementById("cnpjReg");
        const cnpjMask = IMask(cnpjInput, {
            mask: '000.000.000/0000-00'
        });

        const telInput = document.getElementById("telReg");
        const telMask = IMask(telInput, {
            mask: [
                { mask: '(00) 0000-0000' },
                { mask: '(00) 00000-0000' }
            ]
        });

        document.getElementById('btnRegistrar').addEventListener('click', async (event) => {
            event.preventDefault();

            // 1. Captura os valores dos inputs
            const cnpjCliente = document.getElementById('cnpjReg').value;
            const nome = document.getElementById('nomeReg').value;
            const email = document.getElementById('emailReg').value;
            const telefone = document.getElementById('telReg').value;
            const endereco = document.getElementById('endReg').value;
            const senha = document.getElementById('senhaReg').value;

            // 2. Validação simples
            if (!cnpjCliente || !nome || !email || !senha || !telefone || !endereco) {
                alert("Por favor, preencha TODOS os campos.");
                return;
            }

            // 3. Monta o objeto para enviar
            const dadosCliente = {
                cnpjCliente,
                nome,
                email,
                senha,
                telefone,
                endereco
            };

            try {
                const response = await fetch(`${API_URL}/auth/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(dadosCliente)
                });

                const data = await response.json();

                if (response.ok) {
                    alert("Conta criada com sucesso! Faça login.");
                    window.location.href = 'login.html';
                } else {
                    alert("Erro no cadastro: " + (data.message || "Verifique os dados"));
                }

            } catch (error) {
                console.error("Erro:", error);
                alert("Erro ao conectar com o servidor.");
            }
        });
    </script>
</body>

</html>